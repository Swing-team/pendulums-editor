!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),s=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),l=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),n=tinymce.util.Tools.resolve("tinymce.util.VK"),c=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),y=tinymce.util.Tools.resolve("tinymce.util.Tools"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),o=function(e){return e&&/^(LI|DT|DD)$/.test(e.nodeName)},r=function(e){return e&&"BR"===e.nodeName},i=function(e){return e&&3===e.nodeType},L=function(e){return e&&/^(OL|UL|DL)$/.test(e.nodeName)},a=o,f=function(e){if(e&&o(e))for(var t=0,n=e.children;t<n.length;t++){var r=n[t];if("INPUT"===r.nodeName&&"checkbox"===r.type)return!0}return!1},d=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},u=function(e){return e&&"INPUT"===e.nodeName&&"checkbox"===e.type},S=r,m=function(e){return e.parentNode.firstChild===e},g=function(e){return e.parentNode.lastChild===e},b=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},p=function(e,t){return e&&e.nodeName in t},h=function(e,t){return!!r(t)&&!(!e.isBlock(t.nextSibling)||r(t.previousSibling))},v=function(e,t,n){var r=e.isEmpty(t);return!(n&&0<e.select("span[data-mce-type=bookmark]",t).length)&&r},C=function(e,t){return e.isChildOf(t,e.getRoot())},N=function(e,t){var n=s.getNode(e,t);return a(e)&&i(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:{container:e,offset:t}},k=function(e){var t=e.cloneRange(),n=N(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=N(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},B=t.DOM,I=function(o){var i={},e=function(e){var t,n,r;n=o[e?"startContainer":"endContainer"],r=o[e?"startOffset":"endOffset"],1===n.nodeType&&(t=B.create("span",{"data-mce-type":"bookmark"}),n.hasChildNodes()?(r=Math.min(r,n.childNodes.length-1),e?n.insertBefore(t,n.childNodes[r]):B.insertAfter(t,n.childNodes[r])):n.appendChild(t),n=t,r=0),i[e?"startContainer":"endContainer"]=n,i[e?"startOffset":"endOffset"]=r};return e(!0),o.collapsed||e(),i},T=function(o){function e(e){var t,n,r;t=r=o[e?"startContainer":"endContainer"],n=o[e?"startOffset":"endOffset"],t&&(1===t.nodeType&&(n=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(t),t=t.parentNode,B.remove(r),!t.hasChildNodes()&&B.isBlock(t)&&t.appendChild(B.create("br"))),o[e?"startContainer":"endContainer"]=t,o[e?"startOffset":"endOffset"]=n)}e(!0),e();var t=B.createRng();return t.setStart(o.startContainer,o.startOffset),o.endContainer&&t.setEnd(o.endContainer,o.endOffset),k(t)},D=t.DOM,O=function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),v(e,r)&&D.remove(r)):D.setStyle(r,"listStyleType","none")),L(r)&&(n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t)},E=function(t,e){y.each(y.grep(t.select("ol,ul",e)),function(e){O(t,e)})},R=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),U=function(e){var t=e.selection.getStart(!0);return e.dom.getParent(t,"OL,UL,DL",P(e,t))},P=function(e,t){var n=e.dom.getParents(t,"TD,TH");return 0<n.length?n[0]:e.getBody()},x={getParentList:U,getSelectedSubLists:function(e){var t,n,r,o=U(e),i=e.selection.getSelectedBlocks();return r=i,(n=o)&&1===r.length&&r[0]===n?(t=o,y.grep(t.querySelectorAll("ol,ul,dl"),function(e){return L(e)})):y.grep(i,function(e){return L(e)&&o!==e})},getSelectedListItems:function(e){var n,t,r,o=e.selection.getSelectedBlocks();return y.grep((n=e,t=o,r=y.map(t,function(e){var t=n.dom.getParent(e,"li,dd,dt",P(n,e));return t||e}),R.unique(r)),function(e){return a(e)})},getClosestListRootElm:P},A=tinymce.util.Tools.resolve("tinymce.Env"),H=t.DOM,_=function(e,t,n){var r,o,i,a=H.createFragment(),d=e.schema.getBlockElements();if(e.settings.forced_root_block&&(n=n||e.settings.forced_root_block),n){(o=H.create(n)).tagName===e.settings.forced_root_block&&H.setAttribs(o,e.settings.forced_root_block_attrs);for(var s=0,l=t.children;s<l.length;s++){var c=l[s];u(c)&&t.removeChild(c)}p(t.firstChild,d)||a.appendChild(o)}if(t)for(;r=t.firstChild;){var f=r.nodeName;i||"SPAN"===f&&"bookmark"===r.getAttribute("data-mce-type")||(i=!0),p(r,d)?(a.appendChild(r),o=null):n?(o||(o=H.create(n),a.appendChild(o)),o.appendChild(r)):a.appendChild(r)}return e.settings.forced_root_block?i||A.ie&&!(10<A.ie)||o.appendChild(H.create("br",{"data-mce-bogus":"1"})):a.appendChild(H.create("br")),a},K=t.DOM,M=function(e,t,n,r){var o,i,a,d,s;for(a=K.select('span[data-mce-type="bookmark"]',t),function(e){for(var t=0,n=e.children[0].children;t<n.length;t++){var r=n[t];"INPUT"===r.nodeName&&e.children[0].removeChild(r)}}(r=r||_(e,n)),(o=K.createRng()).setStartAfter(n),o.setEndAfter(t),d=(i=o.extractContents()).firstChild;d;d=d.firstChild)if("LI"===d.nodeName&&e.dom.isEmpty(d)){K.remove(d);break}e.dom.isEmpty(i)||K.insertAfter(i,t),K.insertAfter(r,t),v(e.dom,n.parentNode)&&(s=n.parentNode,y.each(a,function(e){s.parentNode.insertBefore(e,n.parentNode)}),K.remove(s)),K.remove(n),v(e.dom,t)&&K.remove(t)},X=t.DOM,$=function(e,t){v(e,t)&&X.remove(t)},w=function(e,t){var n,r,o=t.parentNode;return o?(n=o.parentNode,o===e.getBody()||("DD"===t.nodeName?X.rename(t,"DT"):m(t)&&g(t)?"LI"===n.nodeName?(X.insertAfter(t,n),$(e.dom,n),X.remove(o)):L(n)?X.remove(o,!0):(n.insertBefore(_(e,t),o),X.remove(o)):m(t)?"LI"===n.nodeName?(X.insertAfter(t,n),t.appendChild(o),$(e.dom,n)):L(n)?n.insertBefore(t,o):(n.insertBefore(_(e,t),o),X.remove(t)):g(t)?"LI"===n.nodeName?X.insertAfter(t,n):L(n)?X.insertAfter(t,o):(X.insertAfter(_(e,t),o),X.remove(t)):("LI"===n.nodeName?(o=n,r=_(e,t,"LI")):r=L(n)?_(e,t,"LI"):_(e,t),M(e,o,t,r),E(e.dom,o.parentNode)))):$(e.dom,t),!0},Q=w,W=function(e){var t=x.getSelectedListItems(e);if(t.length){var n=I(e.selection.getRng()),r=void 0,o=void 0,i=x.getClosestListRootElm(e,e.selection.getStart(!0));for(r=t.length;r--;)for(var a=t[r].parentNode;a&&a!==i;){for(o=t.length;o--;)if(t[o]===a){t.splice(r,1);break}a=a.parentNode}for(r=0;r<t.length&&(w(e,t[r])||0!==r);r++);return e.selection.setRng(T(n)),e.nodeChanged(),!0}},j=function(n,e){y.each(e,function(e,t){n.setAttribute(t,e)})},q=function(e,t,n){var r,o,i,a,d,s,l;r=e,o=t,a=(i=n)["list-style-type"]?i["list-style-type"]:null,r.setStyle(o,"list-style-type",a),d=e,j(s=t,(l=n)["list-attributes"]),y.each(d.select("li",s),function(e){j(e,l["list-item-attributes"])})},F=function(e,t,n,r){var o,i;for(o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&S(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(b(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},V=function(g,p,h){void 0===h&&(h={});var e,t=g.selection.getRng(!0),v="LI",n=x.getClosestListRootElm(g,g.selection.getStart(!0)),C=g.dom;if("false"!==C.getContentEditable(g.selection.getNode())){var N=p=p.toUpperCase();"DL"===p&&(v="DT"),"ULCHECKBOX"===p&&(p="UL"),e=I(t),y.each(function(n,e,r){for(var o,i=[],a=n.dom,t=F(n,e,!0,r),d=F(n,e,!1,r),s=[],l=t;l&&(s.push(l),l!==d);l=l.nextSibling);return y.each(s,function(e){if(b(n,e))return i.push(e),void(o=null);if(a.isBlock(e)||S(e))return S(e)&&a.remove(e),void(o=null);var t=e.nextSibling;c.isBookmarkNode(e)&&(b(n,t)||!t&&e.parentNode===r)?o=null:(o||(o=a.create("p"),e.parentNode.insertBefore(o,e),i.push(o)),o.appendChild(e))}),i}(g,t,n),function(e){var t,n,r,o,i,a,d,s,l;if((n=e.previousSibling)&&L(n)&&n.nodeName===p&&(r=n,o=h,i=C.getStyle(r,"list-style-type"),a=o?o["list-style-type"]:"",i===(a=null===a?"":a)))t=n,e=C.rename(e,v),n.appendChild(e);else{if(t=C.create(p),"ULCHECKBOX"===N){var c=C.create("INPUT");c.type="checkbox",e.insertBefore(c,e.firstChild);for(var f=0,u=e.children;f<u.length;f++){var m=u[f];S(m)&&C.remove(m)}}e.parentNode.insertBefore(t,e),t.appendChild(e),e=C.rename(e,v)}d=C,s=e,l=["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],y.each(l,function(e){var t;return d.setStyle(s,((t={})[e]="",t))}),q(C,t,h),J(g.dom,t)}),g.selection.setRng(T(e))}},z=function(r){var e=I(r.selection.getRng(!0)),o=x.getClosestListRootElm(r,r.selection.getStart(!0)),t=x.getSelectedListItems(r),n=y.grep(t,function(e){return r.dom.isEmpty(e)});t=y.grep(t,function(e){return!r.dom.isEmpty(e)}),y.each(n,function(e){v(r.dom,e)&&Q(r,e)}),y.each(t,function(e){var t,n;if(e.parentNode!==r.getBody()){for(t=e;t&&t!==o;t=t.parentNode)L(t)&&(n=t);M(r,n,e),E(r.dom,n.parentNode)}}),r.selection.setRng(T(e))},G=function(e,t,n){return s=n,(d=t)&&s&&L(d)&&d.nodeName===s.nodeName&&(i=t,a=n,(o=e).getStyle(i,"list-style-type",!0)===o.getStyle(a,"list-style-type",!0))&&(r=n,t.className===r.className);var r,o,i,a,d,s},J=function(e,t){var n,r;if(n=t.nextSibling,G(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,G(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},Y=function(t,e,n,r,o){if(e.nodeName!==r&&("ULCHECKBOX"!==r||"UL"!==e.nodeName)||Z(o)){var i=I(t.selection.getRng(!0));y.each([e].concat(n),function(e){!function(e,t,n,r){if(t.nodeName!==n){var o=e.rename(t,n);q(e,o,r)}else q(e,t,r)}(t.dom,e,r,o)}),t.selection.setRng(T(i))}else z(t)},Z=function(e){return"list-style-type"in e},ee={toggleList:function(e,t,n){var r=x.getParentList(e),o=x.getSelectedSubLists(e);n=n||{},r&&0<o.length?Y(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n&&("ULCHECKBOX"!==n||"UL"!==t.nodeName)||Z(r)){var o=I(e.selection.getRng(!0));q(e.dom,t,r),J(e.dom,e.dom.rename(t,n)),e.selection.setRng(T(o))}else z(e);else V(e,n,r)}(e,r,t,n)},removeList:z,mergeWithAdjacentLists:J},te=function(e,t,n,r){var o,i,a=t.startContainer,d=t.startOffset;if(3===a.nodeType&&(n?d<a.data.length:0<d))return a;for(o=e.schema.getNonEmptyElements(),1===a.nodeType&&(a=s.getNode(a,d)),i=new l(a,r),n&&h(e.dom,a)&&i.next();a=i[n?"next":"prev2"]();){if("LI"===a.nodeName&&!a.hasChildNodes())return a;if(n&&f(a)&&u(a.lastChild))return a;if(o[a.nodeName]&&!u(a))return a;if(3===a.nodeType&&0<a.data.length)return a}},ne=function(e,t){var n=t.childNodes;return 1===n.length&&!L(n[0])&&e.isBlock(n[0])},re=function(e,t,n){var r,o,i,a;if(o=ne(e,n)?n.firstChild:n,ne(i=e,a=t)&&i.remove(a.firstChild,!0),!v(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},oe=function(e,t,n){var r,o,i=t.parentNode;if(C(e,t)&&C(e,n)){if(L(n.lastChild)&&(o=n.lastChild),i===n.lastChild&&S(i.previousSibling)&&e.remove(i.previousSibling),(r=n.lastChild)&&S(r)&&t.hasChildNodes()&&e.remove(r),t.hasChildNodes()&&f(t))for(var a=0,d=t.children;a<d.length;a++){var s=d[a];u(s)&&e.remove(s)}v(e,n,!0)&&e.$(n).empty(),re(e,t,n),o&&n.appendChild(o),e.remove(t),v(e,i)&&i!==e.getRoot()&&e.remove(i)}},ie=function(e,t,n,r){var o,i,a,d=e.dom;if(d.isEmpty(r))i=n,a=r,(o=e).dom.$(a).empty(),oe(o.dom,i,a),o.selection.setCursorLocation(a);else{var s=I(t);oe(d,n,r),e.selection.setRng(T(s))}},ae=function(e,t){var n,r,o,i=e.dom,a=e.selection,d=a.getStart(),s=x.getClosestListRootElm(e,d),l=i.getParent(a.getStart(),"LI",s);if(l){if((n=l.parentNode)===e.getBody()&&v(i,n))return!0;if(r=k(a.getRng(!0)),(o=i.getParent(te(e,r,t,s),"LI",s))&&o!==l)return t?ie(e,r,o,l):function(e,t,n,r){var o=I(t);oe(e.dom,n,r);var i=T(o);e.selection.setRng(i)}(e,r,l,o),!0;if(!o&&!t)return ee.removeList(e),!0}return!1},de=function(e,t){return ae(e,t)||function(o,i){var a=o.dom,e=o.selection.getStart(),d=x.getClosestListRootElm(o,e),s=a.getParent(e,a.isBlock,d);if(s&&a.isEmpty(s)){var t=k(o.selection.getRng(!0)),l=a.getParent(te(o,t,i,d),"LI",d);if(l)return o.undoManager.transact(function(){var e,t,n,r;t=s,n=d,r=(e=a).getParent(t.parentNode,e.isBlock,n),e.remove(t),r&&e.isEmpty(r)&&e.remove(r),ee.mergeWithAdjacentLists(a,l.parentNode),o.selection.select(l,!0),o.selection.collapse(i)}),!0}return!1}(e,t)},se=function(e,t){return e.selection.isCollapsed()?de(e,t):(r=(n=e).selection.getStart(),o=x.getClosestListRootElm(n,r),!!(n.dom.getParent(r,"LI,DT,DD",o)||0<x.getSelectedListItems(n).length)&&(n.undoManager.transact(function(){n.execCommand("Delete"),E(n.dom,n.getBody())}),!0));var n,r,o},le=function(t){t.on("keydown",function(e){e.keyCode===n.BACKSPACE?se(t,!1)&&e.preventDefault():e.keyCode===n.DELETE&&se(t,!0)&&e.preventDefault()})},ce=se,fe=function(t){return{backspaceDelete:function(e){ce(t,e)}}},ue=t.DOM,me=function(e,t){var n;if(L(e)){for(;n=e.firstChild;)t.appendChild(n);ue.remove(e)}},ge=function(e){var t,n,r,o,i=x.getSelectedListItems(e);if(i.length){for(var a=I(e.selection.getRng(!0)),d=0;d<i.length&&(t=i[d],o=r=n=void 0,("DT"===t.nodeName?(ue.rename(t,"DD"),1):(n=t.previousSibling)&&L(n)?(n.appendChild(t),1):n&&"LI"===n.nodeName&&L(n.lastChild)?(n.lastChild.appendChild(t),me(t.lastChild,n.lastChild),1):(n=t.nextSibling)&&L(n)?(n.insertBefore(t,n.firstChild),1):(n=t.previousSibling)&&"LI"===n.nodeName&&(r=ue.create(t.parentNode.nodeName),(o=ue.getStyle(t.parentNode,"listStyleType"))&&ue.setStyle(r,"listStyleType",o),n.appendChild(r),r.appendChild(t),me(t.lastChild,r),1))||0!==d);d++);return e.selection.setRng(T(a)),e.nodeChanged(),!0}},pe=function(t,n){return function(){var e=t.dom.getParent(t.selection.getStart(),"UL,OL,DL, ULCHECKBOX");return e&&e.nodeName===n}},he=function(r){r.on("BeforeExecCommand",function(e){var t,n=e.command.toLowerCase();if("indent"===n?ge(r)&&(t=!0):"outdent"===n&&W(r)&&(t=!0),t)return r.fire("ExecCommand",{command:e.command}),e.preventDefault(),!0}),r.addCommand("InsertUnorderedList",function(e,t){ee.toggleList(r,"UL",t)}),r.addCommand("InsertCheckbox",function(e,t){ee.toggleList(r,"ULCHECKBOX",t)}),r.addCommand("InsertOrderedList",function(e,t){ee.toggleList(r,"OL",t)}),r.addCommand("InsertDefinitionList",function(e,t){ee.toggleList(r,"DL",t)}),r.addQueryStateHandler("InsertUnorderedList",pe(r,"UL")),r.addQueryStateHandler("InsertOrderedList",pe(r,"OL")),r.addQueryStateHandler("InsertDefinitionList",pe(r,"DL")),r.addQueryStateHandler("InsertCheckbox",pe(r,"ULCHECKBOX"))},ve=function(e){return e.getParam("lists_indent_on_tab",!0)},Ce=function(e){var t;ve(e)&&(t=e).on("keydown",function(e){e.keyCode!==n.TAB||n.metaKeyPressed(e)||t.dom.getParent(t.selection.getStart(),"LI,DT,DD")&&(e.preventDefault(),e.shiftKey?W(t):ge(t))}),le(e)},Ne=function(t,a){return function(e){var i=e.control;t.on("NodeChange",function(e){var t=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}(e.parents,d),n=-1!==t?e.parents.slice(0,t):e.parents,r=y.grep(n,L),o=!1;0<r.length&&0<r[0].children[0].children.length&&"INPUT"===r[0].children[0].children[0].nodeName&&(o=!0),"ULCHECKBOX"===a?i.active(0<r.length&&"UL"===r[0].nodeName&&o):i.active(0<r.length&&r[0].nodeName===a&&!o)})}},ye=function(e){var t,n,r,o;n="advlist",r=(t=e).settings.plugins?t.settings.plugins:"",-1===y.inArray(r.split(/[ ,]/),n)&&(e.addButton("numlist",{active:!1,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:Ne(e,"OL")}),e.addButton("bullist",{active:!1,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:Ne(e,"UL")}),e.addButton("checkbox",{active:!1,text:"checkbox",onPostRender:Ne(e,"ULCHECKBOX"),cmd:"InsertCheckbox"})),e.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent",onPostRender:(o=e,function(e){var n=e.control;o.on("nodechange",function(){var e=x.getSelectedListItems(o),t=0<e.length&&m(e[0]);n.disabled(t)})})})};e.add("listwithcheckbox",function(o){return Ce(o),ye(o),he(o),o.on("selectionchange",function(e){var t=o.selection.getNode(),n=o.selection.getRng();if("LI"===t.nodeName&&0<t.children.length&&"INPUT"===t.firstChild.nodeName&&"checkbox"===t.firstChild.type&&0===n.startOffset&&o.selection.isCollapsed()){var r=n.cloneRange();r.setStartAfter(t.firstChild),o.selection.setRng(r)}}),fe(o)})}();